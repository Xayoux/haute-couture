)
library(tidyverse)
library(here)
library(analyse.competitivite)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 71),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
library(tidyverse)
library(here)
library(analyse.competitivite)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 71),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
View(df_product)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 71),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS22",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 71),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS96",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 71),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product |>
filter(str_detect(HS92, "42"))
df_product |>
filter(str_detect(HS92, "^42"))
df_product |>
filter(str_detect(HS92, "^42")) |>
nrow()
df_product |>
filter(str_detect(HS92, "^61|^62|^63")) |>
nrow()
df_product |>
filter(str_detect(HS92, "^64")) |>
nrow()
df_product |>
filter(str_detect(HS92, "^71")) |>
nrow()
22+291+29+52
22+294+40+9
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product |>
filter(str_detect(HS92, "^71")) |>
nrow()
22+294+40+9
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS02",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS96",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS22",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
View(df_product)
codes <- c(42, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117)
library(concordance)
detach("package:concordance", unload = TRUE)
remove.packages("concordance", lib="~/AppData/Local/R/win-library/4.3")
install_github("insongkim/concordance", dependencies=TRUE)
library(tidyverse)
library(here)
library(analyse.competitivite)
codes <- c(42, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = FALSE
)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS17",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
library(tidyverse)
library(here)
library(analyse.competitivite)
codes <- c(42, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
View(df_product2)
df_product2 |>
filter(HS22 != HS92)
codes <- c(4202, 4203, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
View(df_product2)
View(df_product2)
codes <- c(4202, 4203, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117)
df_product2 <-
extract_product(
codes_vector = c(42, 61, 62, 63, 64, 7113, 7114, 7116, 7117),
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
df_product2 <-
extract_product(
codes_vector = codes,
path_output = here("processed-data", "codes-produits2.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
View(df_product2)
View(df_product2)
df_product2 |>
filter(HS92!=HS22)
df_product2 |>
filter(HS92!=HS22) |> view()
requireNamespace("devtools", quietly = TRUE)
require("devtools")
if (!require("devtools")) {
install.packages("devtools")
}
if (!require("arrow")) {
install.packages("arrow")
}
install.packages("arrow")
remove.packages("arrow", lib="~/AppData/Local/R/win-library/4.3")
!require("arrow")
if (!require("arrow")) {
install.packages("arrow")
}
remove.packages("glue", lib="~/AppData/Local/R/win-library/4.3")
install.packages("glue")
install.packages("arrow")
install.packages("glue")
install.packages("glue")
require(arrow)
!require(arrow)
if(!require(arrow)) install.packages("arrow")
install.packages("arrow")
remove.packages("glue", lib="~/AppData/Local/R/win-library/4.3")
if(!require(glue)) install.packages("glue")
# Tester si devtools est installé. Si ce n'est pas le cas, l'installer
# Permet d'installer le package concordance de github pour pouvoir effectuer
# Des correspondances avec la dernière version de la nomenclature.
if(!require(devtools)) install.packages("devtools")
if(!require(concordance)) install_github("insongkim/concordance", dependencies=TRUE)
# Créer un dataframe contenant les correspondances entre les codes produits de la nomenclature HS22 et HS92
df_product <-
extract_product(
codes_vector = chapter_codes,
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
library(tidyverse)
library(here)
library(analyse.competitivite)
# Vecteur contenant les numéros des chapitres / des sous-sections de la nomenclature pour les produits voulus
chapter_codes <- c(4202, 4203, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117)
# Créer un dataframe contenant les correspondances entre les codes produits de la nomenclature HS22 et HS92
df_product <-
extract_product(
codes_vector = chapter_codes,
path_output = here("processed-data", "codes-produits.xlsx"),
revision_origin = "HS22",
revision_destination = "HS92",
export = TRUE,
return_df = TRUE,
correspondance = TRUE
)
library(here)
library(tidyverse)
library(arrow)
path <- "d:/capliez/Documents/BACI/BACI_HS92_V202401/BACI_HS92_Y2022_V202401.csv"
path |>
read_csv()
df<-
path |>
read_csv_arroww()
df<-
path |>
read_csv_arrow()
df
df<-
path |>
read_csv_arrow(as_data_frame = FALSE)
df
df <-
df |>
filter(k %in% c(4202, 4203, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117),
i > 50) |>
group_by(k, i, j) |>
count()
df
df <-
df |>
collect()
View(df)
df<-
path |>
read_csv_arrow(as_data_frame = FALSE)
df <-
df |>
filter(k %in% c(4202, 4203, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117),
i > 50)
df <-
df |>
collect()
View(df)
df<-
path |>
read_csv_arrow(as_data_frame = FALSE)
df <-
df |>
filter(k %in% c(4202, 4203, 61, 62, 64, 6504, 6505, 6506, 7113, 7114, 7116, 7117))
df <-
df |>
collect()
df<-
path |>
read_csv_arrow(as_data_frame = FALSE)
df <-
df |>
filter(i > 50) |>
group_by(k, i, j) |>
count()
df <-
df |>
collect()
View(df)
library(tictoc)
library(here)
library(tidyverse)
library(arrow)
library(tictoc)
install.packages("tictoc")
library(here)
library(tidyverse)
library(arrow)
library(tictoc)
path <- "d:/capliez/Documents/BACI/BACI_HS92_V202401/BACI_HS92_Y2022_V202401.csv"
tic()
df<-
path |>
read_csv_arrow(as_data_frame = FALSE)
df <-
df |>
filter(i > 50) |>
group_by(k, i, j) |>
count()
df <-
df |>
collect()
toc()
tic()
df2<-
path |>
read_csv()
df2 <-
df2 |>
filter(i > 50) |>
group_by(k, i, j) |>
count()
View(df2)
df_product <- here("processed_data","df_product.csv")
df_product <- here("processed_data","df_product.csv") |>
read_excel()
library(readxl)
path <- "d:/capliez/Documents/BACI/BACI_HS92_V202401/BACI_HS92_Y2022_V202401.csv"
df_product <- here("processed_data","df_product.csv") |>
read_excel()
df_product <- here("processed_data","codes-produits.csv") |>
read_excel()
df_product <- here("processed_data","codes-produits.xlsx") |>
read_excel()
df_product <- here("processed-data","codes-produits.xlsx") |>
read_excel()
library(here)
library(tidyverse)
library(arrow)
library(tictoc)
library(readxl)
path <- "d:/capliez/Documents/BACI/BACI_HS92_V202401/BACI_HS92_Y2022_V202401.csv"
df_product <- here("processed-data","codes-produits.xlsx") |>
read_excel()
codes <- unlist(unique(df_product$HS92))
df_country_codes <- "d:/capliez/Documents/BACI/BACI_HS92_V202401/product_codes_V202401.csv" |>
read_csv()
df_country_codes <- "d:/capliez/Documents/BACI/BACI_HS92_V202401/country_codes_V202401.csv" |>
read_csv()
View(df_country_codes)
df_country_codes <- "d:/capliez/Documents/BACI/BACI_HS92_V202401/country_codes_V202401.csv" |>
read_csv() |>
select(country_code, country_iso3)
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
left(joindf_country_codes, by = c("i" = "country_code")) |>
rename(exporter = country_iso3) |>
collect()
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
left_join(joindf_country_codes, by = c("i" = "country_code")) |>
rename(exporter = country_iso3) |>
collect()
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
left_join(df_country_codes, by = c("i" = "country_code")) |>
rename(exporter = country_iso3) |>
collect()
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
# left_join(df_country_codes, by = c("i" = "country_code")) |>
# rename(exporter = country_iso3) |>
collect()
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
left_join(df_country_codes, by = c("i" = "country_code")) |>
# rename(exporter = country_iso3) |>
collect()
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE)
df_baci
glimpse(df_country_codes))
glimpse(df_country_codes)
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
mutate(i = as.double(i))
df_baci
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
mutate(i = as.double(i)) |>
left_join(df_country_codes, by = c("i" = "country_code")) |>
# rename(exporter = country_iso3) |>
collect()
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
mutate(i = as.double(i)) |>
left_join(df_country_codes, by = c("i" = "country_code")) |>
rename(exporter = country_iso3) |>
collect()
View(df_baci)
df_baci <-
path |>
read_csv_arrow(as_data_frame = FALSE) |>
filter(k %in% codes) |>
mutate(i = as.double(i),
j = as.double(j)) |>
left_join(df_country_codes, by = c("i" = "country_code")) |>
rename(exporter = country_iso3) |>
left_join(df_country_codes, by = c("j" = "country_code")) |>
rename(importer = country_iso3) |>
collect()
View(df_baci)
here("..", "BACI", "BACI_HS92_V202401") |>
list.files(full.names = TRUE, pattern = "^BACI")
View(df_country_codes)
df3<-
here("..", "BACI", "BACI_HS92_V202401") |>
list.files(full.names = TRUE, pattern = "^BACI") |>
open_dataset(format = "csv") |>
filter(i == 4) |>
collect()
View(df3)
